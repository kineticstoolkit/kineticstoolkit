

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Inverse Dynamics &#8212; Kinetics Toolkit master documentation</title>
    <link rel="stylesheet" href="_static/material.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Cycles" href="cycles.html" />
    <link rel="prev" title="Pushrim Kinetics" href="pushrimkinetics.html" />



  
   

  </head>
  <body dir=ltr
        data-md-color-primary=white data-md-color-accent=orange>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#inversedynamics" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="Kinetics Toolkit master documentation"
           class="md-header-nav__button md-logo">
          
              <img src="_static/logo.png" height="26"
                   alt="Kinetics Toolkit master documentation logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Kinetics Toolkit</span>
          <span class="md-header-nav__topic"> Inverse Dynamics </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/felixchenier/kineticstoolkit/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    kineticstoolkit
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = ""versions.json"",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="Kinetics Toolkit master documentation" class="md-nav__button md-logo">
      
        <img src="_static/logo.png" alt=" logo" width="48" height="48">
      
    </a>
    <a href="index.html"
       title="Kinetics Toolkit master documentation">Kinetics Toolkit</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/felixchenier/kineticstoolkit/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    kineticstoolkit
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="install.html" class="md-nav__link">Installing the stable version</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="install_develop.html" class="md-nav__link">Installing the development version</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="labmode.html" class="md-nav__link">Lab mode</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="timeseries.html" class="md-nav__link">Getting started with TimeSeries</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="loadsave.html" class="md-nav__link">Saving and loading</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="geometry.html" class="md-nav__link">Geometry</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="filters.html" class="md-nav__link">Filters</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="kinematics.html" class="md-nav__link">Kinematics</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="pushrimkinetics.html" class="md-nav__link">Pushrim Kinetics</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Inverse Dynamics </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Inverse Dynamics</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#inversedynamics--page-root" class="md-nav__link">Inverse Dynamics</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Loading-sample-data" class="md-nav__link">Loading sample data</a>
        </li>
        <li class="md-nav__item"><a href="#Calculate-the-force-and-moments-at-the-hand" class="md-nav__link">Calculate the force and moments at the hand</a>
        </li>
        <li class="md-nav__item"><a href="#Calculate-the-force-and-moments-at-the-elbow" class="md-nav__link">Calculate the force and moments at the elbow</a>
        </li>
        <li class="md-nav__item"><a href="#Calculate-the-force-and-moments-at-the-shoulder" class="md-nav__link">Calculate the force and moments at the shoulder</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="cycles.html" class="md-nav__link">Cycles</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="dbinterface.html" class="md-nav__link">DBInterface</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="release_notes.html" class="md-nav__link">Release Notes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="https://felixchenier.uqam.ca/kineticstoolkit" class="md-nav__link">Stable version</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="api_reference.html" class="md-nav__link">API Reference</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#inversedynamics--page-root" class="md-nav__link">Inverse Dynamics</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Loading-sample-data" class="md-nav__link">Loading sample data</a>
        </li>
        <li class="md-nav__item"><a href="#Calculate-the-force-and-moments-at-the-hand" class="md-nav__link">Calculate the force and moments at the hand</a>
        </li>
        <li class="md-nav__item"><a href="#Calculate-the-force-and-moments-at-the-elbow" class="md-nav__link">Calculate the force and moments at the elbow</a>
        </li>
        <li class="md-nav__item"><a href="#Calculate-the-force-and-moments-at-the-shoulder" class="md-nav__link">Calculate the force and moments at the shoulder</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>

<h1 id="inversedynamics--page-root">Inverse Dynamics<a class="headerlink" href="#inversedynamics--page-root" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="api/kineticstoolkit.inversedynamics.html"><span class="doc">inversedynamics</span></a> module calculates the proximal forces and moments based on the segment’s kinematics and distal forces and moments, based on the general method published in [1].</p>
<p>The results are the forces and moments applied by the distal segment on the proximal articulation, in the global coordinates system.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is still a very experimental module that has not been validated yet.</p>
</div>
<p>To date, the following tests were made and were successful:</p>
<ol class="arabic simple">
<li><p>A complete loop from the point of force application point to the force point application, using real wheelchair propulsion data, with a fake mass of 0 kg. In these test conditions, the proximal and distal kinetics are equal, as expected. This test was to verify that the implemented matrices are exempt of sign errors.</p></li>
<li><p>Real wheelchair propulsion data was inspected and seems plausible.</p></li>
</ol>
<p>[1] R. Dumas, R. Aissaoui, and J. A. De Guise, “A 3D generic inverse dynamic method using wrench notation and quaternion algebra,” Comput Meth Biomech Biomed Eng, vol. 7, no. 3, pp. 159–166, 2004.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">kineticstoolkit.lab</span> <span class="k">as</span> <span class="nn">ktk</span>
</pre></div>
</div>
</div>

<h2 id="Loading-sample-data">Loading sample data<a class="headerlink" href="#Loading-sample-data" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial, we will load propulsion data from a sprint in Wheelchair Basketball. Kinetics were recorded using an instrumented wheel (SmartWheel) and kinematics were recorded using an optoelectronic system (Optitrack). Data were preprocessed in Matlab.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Total mass of the participant</span>
<span class="n">total_mass</span> <span class="o">=</span> <span class="mi">75</span>

<span class="c1"># Load kinetics</span>
<span class="n">kinetics</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'data/inversedynamics/basketball_kinetics.mat'</span><span class="p">)</span>
<span class="n">kinetics</span> <span class="o">=</span> <span class="n">kinetics</span><span class="p">[</span><span class="s1">'kineticsSWR'</span><span class="p">]</span>

<span class="c1"># Correct the signs so that the moments are in a correct coordinate system</span>
<span class="c1"># (The SmartWheel usually reports Mz positive when it should be negative)</span>
<span class="n">kinetics</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'Moments'</span><span class="p">][:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">kinetics</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'Moments'</span><span class="p">][:,</span> <span class="mi">2</span><span class="p">]</span>

<span class="c1"># Load kinematics</span>
<span class="n">kinematics</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'data/inversedynamics/basketball_kinematics.mat'</span><span class="p">)</span>
<span class="n">kinematics</span> <span class="o">=</span> <span class="n">kinematics</span><span class="p">[</span><span class="s1">'kinematics'</span><span class="p">]</span>
<span class="n">markers</span> <span class="o">=</span> <span class="n">kinematics</span><span class="p">[</span><span class="s1">'Markers'</span><span class="p">]</span>

<span class="c1"># Sync kinetics and kinematics (there is a 5.525 time lag between both)</span>
<span class="n">markers</span><span class="o">.</span><span class="n">time</span> <span class="o">-=</span> <span class="mf">5.525</span>

<span class="c1"># Merge all under the same ts_all TimeSeries.</span>
<span class="n">ts_all</span> <span class="o">=</span> <span class="n">markers</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">ts_all</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">kinetics</span><span class="p">,</span> <span class="n">resample</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Keep only the sprint data</span>
<span class="n">ts_all</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">get_ts_between_times</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>


<h2 id="Calculate-the-force-and-moments-at-the-hand">Calculate the force and moments at the hand<a class="headerlink" href="#Calculate-the-force-and-moments-at-the-hand" title="Permalink to this headline">¶</a></h2>
<p>The same calculation is done on every segment, from distal to proximal. We begin with the segment ‘Wheel’, since the kinetics are measured at the wheel, and we go up to the hand, which will later be the new point of force application.</p>
<p>We will ignore the inertial parameters of the pushrim.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pushrim_inertial_parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'Mass'</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                               <span class="s1">'COMProximalRatio'</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                               <span class="s1">'GyrationCOMRatio'</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>

<span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">ts_all</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>

<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'ProximalJointPosition'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'BodyR_HandR'</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'DistalJointPosition'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'RearWheelCenterR'</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'ForceApplicationPosition'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'RearWheelCenterR'</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'DistalForces'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'Forces'</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'DistalMoments'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'Moments'</span><span class="p">]</span>

<span class="n">new_ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">calculate_proximal_wrench</span><span class="p">(</span>
        <span class="n">ts</span><span class="p">,</span> <span class="n">pushrim_inertial_parameters</span><span class="p">)</span>

<span class="c1"># Print the results</span>
<span class="n">new_ts</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s1">'DistalForces'</span><span class="p">,</span> <span class="s1">'DistalMoments'</span><span class="p">])</span>
<span class="n">new_ts</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s1">'ProximalForces'</span><span class="p">,</span> <span class="s1">'ProximalMoments'</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING [/Users/felix/Documents/Recherche/ktk_develop/kineticstoolkit/inversedynamics.py:437] COMPosition not found in input TimeSeries. I calculated it.
WARNING [/Users/felix/Documents/Recherche/ktk_develop/kineticstoolkit/filters.py:51] NaNs found in the signal. They have been interpolated before filtering, and then put back in the filtered data.
WARNING [/Users/felix/Documents/Recherche/ktk_develop/kineticstoolkit/inversedynamics.py:443] COMAcceleration not found in input TimeSeries. I calculated it using a low-pass ButterWorth filter of order 4 at 6 Hz.
WARNING [/Users/felix/Documents/Recherche/ktk_develop/kineticstoolkit/inversedynamics.py:450] SegmentAngles not found in input TimeSeries. I calculated it.
WARNING [/Users/felix/Documents/Recherche/ktk_develop/kineticstoolkit/filters.py:51] NaNs found in the signal. They have been interpolated before filtering, and then put back in the filtered data.
WARNING [/Users/felix/Documents/Recherche/ktk_develop/kineticstoolkit/inversedynamics.py:457] AngularVelocity and/or AngularAcceleration not found in input TimeSeries. I calculated it using a low-pass ButterWorth filter of order 4 at 6 Hz.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/inversedynamics_5_1.png" src="_images/inversedynamics_5_1.png"/>
</div>
</div>


<h2 id="Calculate-the-force-and-moments-at-the-elbow">Calculate the force and moments at the elbow<a class="headerlink" href="#Calculate-the-force-and-moments-at-the-elbow" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">ts_all</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>

<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'ProximalJointPosition'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'ElbowR'</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'DistalJointPosition'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'RadialStyloidR'</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'ForceApplicationPosition'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'BodyR_HandR'</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'DistalForces'</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'ProximalForces'</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'DistalMoments'</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'ProximalMoments'</span><span class="p">]</span>

<span class="n">new_ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">calculate_proximal_wrench</span><span class="p">(</span>
        <span class="n">ts</span><span class="p">,</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">get_anthropometrics</span><span class="p">(</span><span class="s1">'ForearmHand'</span><span class="p">,</span> <span class="n">total_mass</span><span class="p">))</span>

<span class="c1"># Print the results</span>
<span class="n">new_ts</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s1">'DistalForces'</span><span class="p">,</span> <span class="s1">'DistalMoments'</span><span class="p">])</span>
<span class="n">new_ts</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s1">'ProximalForces'</span><span class="p">,</span> <span class="s1">'ProximalMoments'</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING [/Users/felix/Documents/Recherche/ktk_develop/kineticstoolkit/inversedynamics.py:437] COMPosition not found in input TimeSeries. I calculated it.
WARNING [/Users/felix/Documents/Recherche/ktk_develop/kineticstoolkit/filters.py:51] NaNs found in the signal. They have been interpolated before filtering, and then put back in the filtered data.
WARNING [/Users/felix/Documents/Recherche/ktk_develop/kineticstoolkit/inversedynamics.py:443] COMAcceleration not found in input TimeSeries. I calculated it using a low-pass ButterWorth filter of order 4 at 6 Hz.
WARNING [/Users/felix/Documents/Recherche/ktk_develop/kineticstoolkit/inversedynamics.py:450] SegmentAngles not found in input TimeSeries. I calculated it.
WARNING [/Users/felix/Documents/Recherche/ktk_develop/kineticstoolkit/filters.py:51] NaNs found in the signal. They have been interpolated before filtering, and then put back in the filtered data.
WARNING [/Users/felix/Documents/Recherche/ktk_develop/kineticstoolkit/inversedynamics.py:457] AngularVelocity and/or AngularAcceleration not found in input TimeSeries. I calculated it using a low-pass ButterWorth filter of order 4 at 6 Hz.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/inversedynamics_7_1.png" src="_images/inversedynamics_7_1.png"/>
</div>
</div>


<h2 id="Calculate-the-force-and-moments-at-the-shoulder">Calculate the force and moments at the shoulder<a class="headerlink" href="#Calculate-the-force-and-moments-at-the-shoulder" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">ts_all</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>

<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'ProximalJointPosition'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'BodyR_AcromionR'</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'DistalJointPosition'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'ElbowR'</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'ForceApplicationPosition'</span><span class="p">]</span> <span class="o">=</span> <span class="n">ts_all</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'ElbowR'</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'DistalForces'</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'ProximalForces'</span><span class="p">]</span>
<span class="n">ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'DistalMoments'</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_ts</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">'ProximalMoments'</span><span class="p">]</span>

<span class="n">new_ts</span> <span class="o">=</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">calculate_proximal_wrench</span><span class="p">(</span>
        <span class="n">ts</span><span class="p">,</span> <span class="n">ktk</span><span class="o">.</span><span class="n">inversedynamics</span><span class="o">.</span><span class="n">get_anthropometrics</span><span class="p">(</span><span class="s1">'UpperArm'</span><span class="p">,</span> <span class="n">total_mass</span><span class="p">))</span>

<span class="c1"># Print the results</span>
<span class="n">new_ts</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s1">'DistalForces'</span><span class="p">,</span> <span class="s1">'DistalMoments'</span><span class="p">])</span>
<span class="n">new_ts</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="s1">'ProximalForces'</span><span class="p">,</span> <span class="s1">'ProximalMoments'</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
WARNING [/Users/felix/Documents/Recherche/ktk_develop/kineticstoolkit/inversedynamics.py:437] COMPosition not found in input TimeSeries. I calculated it.
WARNING [/Users/felix/Documents/Recherche/ktk_develop/kineticstoolkit/filters.py:51] NaNs found in the signal. They have been interpolated before filtering, and then put back in the filtered data.
WARNING [/Users/felix/Documents/Recherche/ktk_develop/kineticstoolkit/inversedynamics.py:443] COMAcceleration not found in input TimeSeries. I calculated it using a low-pass ButterWorth filter of order 4 at 6 Hz.
WARNING [/Users/felix/Documents/Recherche/ktk_develop/kineticstoolkit/inversedynamics.py:450] SegmentAngles not found in input TimeSeries. I calculated it.
WARNING [/Users/felix/Documents/Recherche/ktk_develop/kineticstoolkit/filters.py:51] NaNs found in the signal. They have been interpolated before filtering, and then put back in the filtered data.
WARNING [/Users/felix/Documents/Recherche/ktk_develop/kineticstoolkit/inversedynamics.py:457] AngularVelocity and/or AngularAcceleration not found in input TimeSeries. I calculated it using a low-pass ButterWorth filter of order 4 at 6 Hz.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/inversedynamics_9_1.png" src="_images/inversedynamics_9_1.png"/>
</div>
</div>
<p>For more information on inversedynamics, please check the <a class="reference internal" href="api/kineticstoolkit.inversedynamics.html"><span class="doc">API Reference for the inversedynamics module</span></a>.</p>




          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="pushrimkinetics.html" title="Pushrim Kinetics"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Pushrim Kinetics </span>
              </div>
            </a>
          
          
            <a href="cycles.html" title="Cycles"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Cycles </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2020, Félix Chénier.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>